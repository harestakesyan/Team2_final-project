---
title: "Team 2 EDA"
author: "Karina Martinez"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
library(ezids)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

# Team 2 Final Project - EDA
This Cardiovascular Disease dataset is from [Kaggle](https://www.kaggle.com/datasets/sulianova/cardiovascular-disease-dataset). The variables are:  

Variable |  Definition  
  :-     |  :---- 
id	 | ID number
age	 | Age in days
gender | Gender (1: women, 2: men)
height | Height in centimeters (cm)
weight | Weight in kilograms (kg)
ap_hi | Systolic blood pressure
ap_lo | Diastolic blood pressure
cholesterol | Cholesterol (1: normal, 2: above normal, 3: well above normal)
gluc | Glucose (1: normal, 2: above normal, 3: well above normal)
smoke | Whether patient smokes or not (0: no, 1: yes)
alco | Whether patient consumes alcohol or not (0: no, 1: yes)
active | Whether patient is physically active or not (0: no, 1: yes)
cardio | Presence or absence of cardiovascular disease (0: absent, 1: present)

```{r, results='markup'}
cardio = data.frame(read.csv("cardio_train.csv", sep=';'))
xkablesummary(cardio, title = "Cardio Data Frame Summary" )
str(cardio)
```  
There are `r nrow(cardio)` observations in the dataset.  
 
Remove the `id` column and change the following variables to categorical (factors): `gender`, `cholesterol`, `gluc`, `smoke`, `alco`, `active` and `cardio`. The new data frame is saved as `cardio_final`.  
```{r, results='markup'}
names = c('gender','cholesterol','gluc','smoke','alco','active','cardio')
cardio_final <- cardio[-c(1)]
cardio_final[,names] <- lapply(cardio[,names] , factor)
str(cardio_final)
```  

We see that there are unexpected minimum and maximum observations for `height`, `weight`, `ap_hi` and `ap_lo`.  Let's look into these variables.  

```{r}
library(ggplot2)
library(gridExtra)

hist_height = ggplot(cardio_final, aes(height)) + 
  geom_histogram(col="#f67e7d", 
                 fill="#ffb997", 
                 alpha = .9) +
  labs(x="Height (cm)", y="Frequency") +
  labs(title="Height Histogram") 

hist_weight = ggplot(cardio_final, aes(weight)) + 
  geom_histogram(col="blue", 
                 fill="purple", 
                 alpha = .4) + # opacity
  labs(x="Weight (kg)", y="Frequency") +
  labs(title="Weight Histogram") 

box_height = ggplot(cardio_final, aes(y=height)) + 
  geom_boxplot() + 
  geom_boxplot(colour="#f67e7d", fill="#ffb997", alpha = .9, outlier.colour="red", outlier.size=2) +
  labs(title="Height Boxplot",x="", y = "Height (cm)")

box_weight = ggplot(cardio_final, aes(y=weight)) + 
  geom_boxplot() + 
  geom_boxplot(colour="blue", fill="purple", alpha = .4, outlier.colour="red", outlier.size=2) +
  labs(title="Weight Boxplot",x="", y = "Weight (kg)")

grid.arrange(hist_height, hist_weight, box_height, box_weight, ncol=2, nrow=2)
```  

```{r}
hist_hi = ggplot(cardio_final, aes(ap_hi)) + 
  geom_histogram(col="#f67e7d", 
                 fill="#ffb997", 
                 alpha = .9) +
  labs(x="Systolic blood pressure", y="Frequency") +
  labs(title="Systolic blood pressure Histogram") 

hist_lo = ggplot(cardio_final, aes(ap_lo)) + 
  geom_histogram(col="blue", 
                 fill="purple", 
                 alpha = .4) + # opacity
  labs(x="Diastolic blood pressure", y="Frequency") +
  labs(title="Diastolic blood pressure Histogram") 

box_hi = ggplot(cardio_final, aes(y=ap_hi)) + 
  geom_boxplot() + 
  geom_boxplot(colour="#f67e7d", fill="#ffb997", alpha = .9, outlier.colour="red", outlier.size=2) +
  labs(title="Systolic blood pressure Boxplot",x="", y = "Systolic blood pressure")

box_lo = ggplot(cardio_final, aes(y=ap_lo)) + 
  geom_boxplot() + 
  geom_boxplot(colour="blue", fill="purple", alpha = .4, outlier.colour="red", outlier.size=2) +
  labs(title="Diastolic blood pressure Boxplot",x="", y = "Systolic blood pressure")

grid.arrange(hist_hi, hist_lo, box_hi, box_lo, ncol=2, nrow=2)
```  

**Remove outliers**

There are outliers above and below the medians for `height` and `weight`.  This is also the case for `ap_hi` and `ap_lo`, but the extremely high outliers are clearly impacting the distribution of these variables.

